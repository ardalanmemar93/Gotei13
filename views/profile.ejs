<%- include('./partials/header') %>
<!DOCTYPE html>
<html>
<head>
  <title>User Profile</title>
</head>
<body>
  <h1>User Profile</h1>
  <p>Welcome, <%= user.name %>!</p>
  <h2>Your Characters:</h2>
  <ul>
    <% characters.forEach(function(character) { %>
      <li>
        <strong>Name:</strong> <%= character.name %><br>
        <strong>Race:</strong> <%= character.race %><br>
        <strong>Background:</strong> <%= character.background %><br>
        <strong>Class:</strong> <%= character.dndClass %><br>
        <strong>Equipment:</strong> <%= character.equipment.join(', ') %><br>
      </br>
        <a href="/characters/update/<%= character._id %>">Update</a>
        <form method="POST" action="/characters/<%= character._id %>/publish">
          <button type="submit">Publish</button>
        </form>
        <form
          method="POST"
          action="/characters/<%= character._id %>?_method=DELETE"
        >
          <button type="submit">Delete</button>
        </form>

        <!-- Comment form for each character -->
        <form method="POST" action="/characters/<%= character._id %>/comments">
          <label for="comment">Comment:</label>
          <textarea
            id="comment"
            name="comment"
            rows="4"
            cols="50"
            required
          ></textarea>
          <button type="submit">Submit Comment</button>
        </form>

        <!-- Display existing comments -->
        <h3>Comments:</h3>
        <ul>
          <% character.comments.forEach(function(comment) { %>
            <li>
              <%= comment.text %>
              <form method="POST" action="/characters/<%= character._id %>/comments/<%= comment._id %>?_method=DELETE">
                <button type="submit">Delete Comment</button>
              </form>
            </li>
          <% }); %>
        </ul>
      </li>
    <% }); %>
  </ul>
</body>
</html>
